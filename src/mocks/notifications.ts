import { NotificationItem, ApprovalRequest, AuditTrailEntry } from '@/types/notification';

// Helper to create dates relative to now
const hoursAgo = (hours: number) => new Date(Date.now() - hours * 60 * 60 * 1000);
const hoursFromNow = (hours: number) => new Date(Date.now() + hours * 60 * 60 * 1000);
const daysAgo = (days: number) => new Date(Date.now() - days * 24 * 60 * 60 * 1000);

// Seed 30+ notifications across categories
export const mockNotifications: NotificationItem[] = [
  // Quality/Test alerts (overdue SLA)
  {
    id: 'NOT-001',
    title: 'Test Failure - Pressure Test',
    description: 'Cylinder assembly CYL-2024-001 failed pressure test at 2500 PSI',
    severity: 'critical',
    category: 'quality',
    roleTarget: ['qa_tech', 'supervisor'],
    module: 'test-bench',
    workOrderId: 'WO-2024-001',
    workOrderNumber: 'WO-2024-001',
    itemNumber: 'CYL-HYD-3000',
    status: 'new',
    createdAt: hoursAgo(6),
    slaDueAt: hoursAgo(2), // Overdue
    channels: { inApp: true, email: true, teams: true },
  },
  {
    id: 'NOT-002',
    title: 'Calibration Due - Test Stand A',
    description: 'Pressure gauge calibration expires in 4 hours',
    severity: 'warning',
    category: 'test',
    roleTarget: ['test_bench_operator', 'supervisor'],
    module: 'test-bench',
    status: 'new',
    createdAt: hoursAgo(2),
    slaDueAt: hoursFromNow(4),
    channels: { inApp: true, email: true, teams: false },
  },
  {
    id: 'NOT-003',
    title: 'QC Hold Released',
    description: 'Motor assembly MTR-2024-003 cleared for final QC',
    severity: 'info',
    category: 'quality',
    roleTarget: ['qa_tech'],
    module: 'final-qc',
    workOrderId: 'WO-2024-003',
    workOrderNumber: 'WO-2024-003',
    itemNumber: 'MTR-IND-750W',
    status: 'acknowledged',
    createdAt: hoursAgo(8),
    acknowledgedAt: hoursAgo(4),
    acknowledgedBy: 'qa_tech_1',
    channels: { inApp: true, email: false, teams: false },
  },
  
  // Production/Resource alerts
  {
    id: 'NOT-004',
    title: 'Low Stock - Hydraulic Seals',
    description: 'Seal kit SEL-HYD-025 below reorder point (5 remaining)',
    severity: 'warning',
    category: 'resource',
    roleTarget: ['supervisor', 'admin'],
    module: 'kitting',
    status: 'new',
    createdAt: hoursAgo(3),
    slaDueAt: hoursFromNow(24),
    channels: { inApp: true, email: true, teams: false },
  },
  {
    id: 'NOT-005',
    title: 'Work Order Priority Change',
    description: 'WO-2024-002 escalated to HIGH priority - customer expedite',
    severity: 'warning',
    category: 'production',
    roleTarget: ['operator', 'supervisor'],
    module: 'work-orders',
    workOrderId: 'WO-2024-002',
    workOrderNumber: 'WO-2024-002',
    itemNumber: 'PMP-HYD-150',
    status: 'new',
    createdAt: hoursAgo(1),
    slaDueAt: hoursFromNow(2),
    channels: { inApp: true, email: true, teams: true },
  },
  {
    id: 'NOT-006',
    title: 'Assembly Station Downtime',
    description: 'Station ASM-02 offline for maintenance - ETA 2 hours',
    severity: 'error',
    category: 'production',
    roleTarget: ['operator', 'supervisor'],
    module: 'assembly',
    status: 'acknowledged',
    createdAt: hoursAgo(2),
    acknowledgedAt: hoursAgo(1.5),
    acknowledgedBy: 'supervisor_1',
    channels: { inApp: true, email: false, teams: true },
  },

  // Exception lifecycle
  {
    id: 'NOT-007',
    title: 'NCR Raised - Material Defect',
    description: 'Non-conformance report for batch B-2024-089 - supplier material issue',
    severity: 'error',
    category: 'exception',
    roleTarget: ['qa_tech', 'supervisor', 'admin'],
    module: 'ncr-capa',
    workOrderId: 'WO-2024-004',
    workOrderNumber: 'WO-2024-004',
    status: 'new',
    createdAt: hoursAgo(4),
    slaDueAt: hoursFromNow(8),
    channels: { inApp: true, email: true, teams: true },
  },
  {
    id: 'NOT-008',
    title: 'Rework Required - Valve Assembly',
    description: 'Torque specification not met on VLV-2024-006, requires rework',
    severity: 'warning',
    category: 'exception',
    roleTarget: ['operator', 'qa_tech'],
    module: 'assembly',
    workOrderId: 'WO-2024-006',
    workOrderNumber: 'WO-2024-006',
    itemNumber: 'VLV-CTL-DN50',
    status: 'new',
    createdAt: hoursAgo(5),
    slaDueAt: hoursFromNow(12),
    channels: { inApp: true, email: false, teams: false },
  },
  {
    id: 'NOT-009',
    title: 'Deviation Request Pending',
    description: 'Material substitution request for WO-2024-007 awaiting approval',
    severity: 'warning',
    category: 'exception',
    roleTarget: ['supervisor', 'admin'],
    module: 'work-orders',
    workOrderId: 'WO-2024-007',
    workOrderNumber: 'WO-2024-007',
    status: 'new',
    createdAt: hoursAgo(3),
    slaDueAt: hoursFromNow(6),
    channels: { inApp: true, email: true, teams: false },
  },

  // Packaging/Logistics
  {
    id: 'NOT-010',
    title: 'Shipment Ready for Handover',
    description: 'HPU-2024-005 packed and ready for carrier pickup',
    severity: 'info',
    category: 'packaging',
    roleTarget: ['packaging', 'supervisor'],
    module: 'packing-handover',
    workOrderId: 'WO-2024-005',
    workOrderNumber: 'WO-2024-005',
    itemNumber: 'HPU-STD-20L',
    status: 'new',
    createdAt: hoursAgo(1),
    slaDueAt: hoursFromNow(4),
    channels: { inApp: true, email: true, teams: false },
  },
  {
    id: 'NOT-011',
    title: 'Label Print Queue Alert',
    description: '15 labels pending print - printer PAK-LBL-01 low on media',
    severity: 'warning',
    category: 'logistics',
    roleTarget: ['packaging'],
    module: 'serialization',
    status: 'new',
    createdAt: hoursAgo(0.5),
    slaDueAt: hoursFromNow(1),
    channels: { inApp: true, email: false, teams: false },
  },
  {
    id: 'NOT-012',
    title: 'Carrier Delay Notice',
    description: 'Scheduled pickup delayed 2 hours - carrier equipment issue',
    severity: 'warning',
    category: 'logistics',
    roleTarget: ['packaging', 'supervisor'],
    module: 'packing-handover',
    status: 'acknowledged',
    createdAt: hoursAgo(3),
    acknowledgedAt: hoursAgo(2),
    acknowledgedBy: 'packaging_1',
    channels: { inApp: true, email: true, teams: false },
  },

  // Compliance/Audit
  {
    id: 'NOT-013',
    title: 'Audit Finding - Documentation Gap',
    description: 'Missing traveler signature on WO-2024-008 step 3',
    severity: 'error',
    category: 'compliance',
    roleTarget: ['qa_tech', 'supervisor', 'admin'],
    module: 'work-orders',
    workOrderId: 'WO-2024-008',
    workOrderNumber: 'WO-2024-008',
    status: 'new',
    createdAt: hoursAgo(6),
    slaDueAt: hoursAgo(1), // Overdue
    channels: { inApp: true, email: true, teams: true },
  },
  {
    id: 'NOT-014',
    title: 'Training Certification Expiring',
    description: 'Operator J. Smith hydraulic training expires in 7 days',
    severity: 'warning',
    category: 'compliance',
    roleTarget: ['supervisor', 'admin'],
    module: 'admin',
    status: 'new',
    createdAt: daysAgo(1),
    slaDueAt: hoursFromNow(168), // 7 days
    channels: { inApp: true, email: true, teams: false },
  },
  {
    id: 'NOT-015',
    title: 'Audit Schedule Reminder',
    description: 'Internal quality audit scheduled for next Monday',
    severity: 'info',
    category: 'audit',
    roleTarget: ['qa_tech', 'supervisor', 'admin'],
    module: 'admin',
    status: 'acknowledged',
    createdAt: daysAgo(2),
    acknowledgedAt: daysAgo(1),
    acknowledgedBy: 'admin_1',
    channels: { inApp: true, email: true, teams: false },
  },

  // More Quality alerts
  {
    id: 'NOT-016',
    title: 'Dimensional Check Failed',
    description: 'Manifold MAN-2024-009 OD out of tolerance (+0.05mm)',
    severity: 'error',
    category: 'quality',
    roleTarget: ['qa_tech', 'operator'],
    module: 'in-process-qc',
    workOrderId: 'WO-2024-009',
    workOrderNumber: 'WO-2024-009',
    itemNumber: 'MAN-HYD-6P',
    status: 'new',
    createdAt: hoursAgo(2),
    slaDueAt: hoursFromNow(4),
    channels: { inApp: true, email: false, teams: false },
  },
  {
    id: 'NOT-017',
    title: 'Leak Test Passed with Margin',
    description: 'HPU-2024-010 passed leak test at 98.5% (threshold 95%)',
    severity: 'info',
    category: 'test',
    roleTarget: ['test_bench_operator', 'qa_tech'],
    module: 'test-bench',
    workOrderId: 'WO-2024-010',
    workOrderNumber: 'WO-2024-010',
    itemNumber: 'HPU-STD-20L',
    status: 'closed',
    createdAt: daysAgo(1),
    acknowledgedAt: hoursAgo(20),
    closedAt: hoursAgo(18),
    channels: { inApp: true, email: false, teams: false },
  },

  // Production alerts
  {
    id: 'NOT-018',
    title: 'Batch Complete - Ready for QC',
    description: 'Hose assembly batch HSE-B-2024-012 complete (25 units)',
    severity: 'info',
    category: 'production',
    roleTarget: ['qa_tech', 'supervisor'],
    module: 'assembly',
    status: 'new',
    createdAt: hoursAgo(1),
    channels: { inApp: true, email: false, teams: false },
  },
  {
    id: 'NOT-019',
    title: 'Overtime Authorization Required',
    description: 'Weekend work needed to meet WO-2024-002 deadline',
    severity: 'warning',
    category: 'resource',
    roleTarget: ['supervisor', 'admin'],
    module: 'work-orders',
    workOrderId: 'WO-2024-002',
    workOrderNumber: 'WO-2024-002',
    status: 'new',
    createdAt: hoursAgo(4),
    slaDueAt: hoursFromNow(8),
    channels: { inApp: true, email: true, teams: false },
  },
  {
    id: 'NOT-020',
    title: 'Tool Replacement Needed',
    description: 'Torque wrench TRQ-003 showing drift, schedule replacement',
    severity: 'warning',
    category: 'resource',
    roleTarget: ['supervisor', 'admin'],
    module: 'assembly',
    status: 'new',
    createdAt: hoursAgo(8),
    slaDueAt: hoursFromNow(48),
    channels: { inApp: true, email: true, teams: false },
  },

  // Critical alerts (overdue)
  {
    id: 'NOT-021',
    title: 'Safety Incident Report Due',
    description: 'Near-miss incident report required within 24 hours',
    severity: 'critical',
    category: 'compliance',
    roleTarget: ['supervisor', 'admin'],
    module: 'admin',
    status: 'new',
    createdAt: hoursAgo(20),
    slaDueAt: hoursAgo(4), // Overdue
    channels: { inApp: true, email: true, teams: true },
  },
  {
    id: 'NOT-022',
    title: 'Customer Escalation',
    description: 'Urgent callback required - quality concern on previous shipment',
    severity: 'critical',
    category: 'quality',
    roleTarget: ['supervisor', 'admin'],
    module: 'work-orders',
    status: 'new',
    createdAt: hoursAgo(2),
    slaDueAt: hoursFromNow(1),
    channels: { inApp: true, email: true, teams: true },
  },

  // More mixed notifications
  {
    id: 'NOT-023',
    title: 'Kitting Complete',
    description: 'Kit for WO-2024-003 verified and staged at Station A1',
    severity: 'info',
    category: 'production',
    roleTarget: ['operator'],
    module: 'kitting',
    workOrderId: 'WO-2024-003',
    workOrderNumber: 'WO-2024-003',
    status: 'acknowledged',
    createdAt: hoursAgo(6),
    acknowledgedAt: hoursAgo(5),
    acknowledgedBy: 'operator_1',
    channels: { inApp: true, email: false, teams: false },
  },
  {
    id: 'NOT-024',
    title: 'Serial Number Conflict',
    description: 'Duplicate serial detected - SN-2024-00456 already assigned',
    severity: 'error',
    category: 'exception',
    roleTarget: ['packaging', 'qa_tech'],
    module: 'serialization',
    status: 'new',
    createdAt: hoursAgo(1),
    slaDueAt: hoursFromNow(2),
    channels: { inApp: true, email: true, teams: false },
  },
  {
    id: 'NOT-025',
    title: 'BOM Revision Update',
    description: 'Rev B released for CYL-HYD-3000 - review required',
    severity: 'info',
    category: 'production',
    roleTarget: ['supervisor', 'admin'],
    module: 'work-orders',
    status: 'new',
    createdAt: hoursAgo(12),
    slaDueAt: hoursFromNow(72),
    channels: { inApp: true, email: true, teams: false },
  },
  {
    id: 'NOT-026',
    title: 'Pending Approval - Material Deviation',
    description: 'Alternate supplier material for WO-2024-004',
    severity: 'warning',
    category: 'exception',
    roleTarget: ['qa_tech', 'admin'],
    module: 'ncr-capa',
    workOrderId: 'WO-2024-004',
    workOrderNumber: 'WO-2024-004',
    status: 'new',
    createdAt: hoursAgo(5),
    slaDueAt: hoursFromNow(6),
    channels: { inApp: true, email: true, teams: false },
  },
  {
    id: 'NOT-027',
    title: 'Final QC Approval Needed',
    description: 'PMP-2024-002 awaiting final sign-off',
    severity: 'warning',
    category: 'quality',
    roleTarget: ['qa_tech', 'supervisor'],
    module: 'final-qc',
    workOrderId: 'WO-2024-002',
    workOrderNumber: 'WO-2024-002',
    itemNumber: 'PMP-HYD-150',
    status: 'new',
    createdAt: hoursAgo(3),
    slaDueAt: hoursFromNow(3),
    channels: { inApp: true, email: true, teams: false },
  },
  {
    id: 'NOT-028',
    title: 'Inventory Cycle Count Due',
    description: 'Weekly cycle count for hydraulic components zone',
    severity: 'info',
    category: 'audit',
    roleTarget: ['supervisor'],
    module: 'kitting',
    status: 'new',
    createdAt: hoursAgo(2),
    slaDueAt: hoursFromNow(24),
    channels: { inApp: true, email: false, teams: false },
  },
  {
    id: 'NOT-029',
    title: 'Spares AGING Alert',
    description: '3 items approaching 90-day aging threshold',
    severity: 'warning',
    category: 'logistics',
    roleTarget: ['qa_tech', 'supervisor'],
    module: 'spares-aging',
    status: 'new',
    createdAt: hoursAgo(4),
    slaDueAt: hoursFromNow(48),
    channels: { inApp: true, email: true, teams: false },
  },
  {
    id: 'NOT-030',
    title: 'Shift Handover Summary',
    description: 'Day shift summary - 12 WOs complete, 3 pending, 1 on hold',
    severity: 'info',
    category: 'production',
    roleTarget: ['supervisor', 'admin'],
    module: 'work-orders',
    status: 'closed',
    createdAt: hoursAgo(16),
    acknowledgedAt: hoursAgo(15),
    closedAt: hoursAgo(14),
    channels: { inApp: true, email: true, teams: false },
  },
  {
    id: 'NOT-031',
    title: 'CAPA Action Due',
    description: 'Corrective action CA-2024-005 due for completion',
    severity: 'error',
    category: 'compliance',
    roleTarget: ['qa_tech', 'supervisor', 'admin'],
    module: 'ncr-capa',
    status: 'new',
    createdAt: daysAgo(3),
    slaDueAt: hoursAgo(12), // Overdue
    channels: { inApp: true, email: true, teams: true },
  },
  {
    id: 'NOT-032',
    title: 'Test Equipment Available',
    description: 'Test Stand B back online after maintenance',
    severity: 'info',
    category: 'test',
    roleTarget: ['test_bench_operator', 'supervisor'],
    module: 'test-bench',
    status: 'acknowledged',
    createdAt: hoursAgo(4),
    acknowledgedAt: hoursAgo(3),
    acknowledgedBy: 'test_bench_1',
    channels: { inApp: true, email: false, teams: false },
  },
];

// Mock approval requests
export const mockApprovalRequests: ApprovalRequest[] = [
  {
    id: 'APR-001',
    notificationId: 'NOT-009',
    type: 'deviation',
    requestedBy: 'operator_1',
    requestedAt: hoursAgo(3),
    status: 'pending',
  },
  {
    id: 'APR-002',
    notificationId: 'NOT-026',
    type: 'deviation',
    requestedBy: 'qa_tech_1',
    requestedAt: hoursAgo(5),
    status: 'pending',
  },
  {
    id: 'APR-003',
    notificationId: 'NOT-007',
    type: 'ncr',
    requestedBy: 'qa_tech_1',
    requestedAt: hoursAgo(4),
    status: 'pending',
  },
];

// Mock audit trail
export const mockAuditTrail: AuditTrailEntry[] = [
  {
    id: 'AUD-001',
    entityType: 'notification',
    entityId: 'NOT-003',
    action: 'acknowledged',
    performedBy: 'qa_tech_1',
    performedAt: hoursAgo(4),
    details: { comments: 'Reviewed and cleared' },
  },
  {
    id: 'AUD-002',
    entityType: 'notification',
    entityId: 'NOT-006',
    action: 'acknowledged',
    performedBy: 'supervisor_1',
    performedAt: hoursAgo(1.5),
    details: { comments: 'Maintenance team notified' },
  },
];

// Mutable store for runtime updates
let notificationStore = [...mockNotifications];
let auditStore = [...mockAuditTrail];

export function getNotificationStore() {
  return notificationStore;
}

export function updateNotificationStore(notifications: NotificationItem[]) {
  notificationStore = notifications;
}

export function addAuditEntry(entry: AuditTrailEntry) {
  auditStore = [entry, ...auditStore];
}

export function getAuditStore() {
  return auditStore;
}

export function resetNotificationStore() {
  notificationStore = [...mockNotifications];
  auditStore = [...mockAuditTrail];
}
